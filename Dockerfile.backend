FROM node:20-alpine

<<<<<<< HEAD
# Criar usuário não-root
RUN addgroup -S appgroup && adduser -S appuser -G appgroup

WORKDIR /app

# Copiar arquivos de dependências
COPY package*.json ./

# Instalar dependências com cache em camada separada
RUN npm ci --only=production

# Copiar arquivos do projeto
COPY . .

# Compilar TypeScript
RUN npm run build

# Mudar para usuário não-root
USER appuser

# Expor porta 3000
EXPOSE 3000

# Comando para iniciar a aplicação
=======
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

EXPOSE 3000
>>>>>>> 891f235cf1aa62efe8d618df22d7938b6ec9cb92
CMD ["node", "dist/server/index.js"]